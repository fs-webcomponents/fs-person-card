<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../fs-global/fs-global.html">

<!--
A FamilySearch person card.

Example:

    <fs-person-card pid="PPP-PPPP"></fs-person-card>

@group FamilySearch Elements
@element fs-person-card
@demo demo/index.html
-->
<dom-module id="fs-person-card">

  <style>
    :host {
      display: block;
      box-sizing: border-box;
      border: 1px solid #ccc;
      padding: 8px;
      background-color: #eee;
      max-width: 300px;
    }
    
    .header {
      font-size: 18px;
      font-weight: bold;
    }
  </style>

  <template>
    <div class="header">Loading...</div>
    <img class="loader" src="ajax-loader.gif" />
    <div class="details">
      <div class="pid"></div>
      <div class="lifespan"></div>
    </div>
  </template>

</dom-module>

<script>

  Polymer({

    is: 'fs-person-card',

    properties: {

      /**
       * Person ID
       *
       * @type {{name: string, image: string}}
       */
      pid: String

    },
    
    behaviors: [FSBehaviors.ClientBehavior],

    attached: function() {
      var self = this;
      self.getClient().getAccessToken().then(function(){
        return client.getPerson(self.pid);
      }).then(function(response){
        self.displayPerson(response.getPerson());
      }).catch(function(e){
        console.error(e.stack);
      });
    },
    
    displayPerson: function(person){
      this.$$('.header').textContent = person.getDisplayName();
      this.$$('.pid').textContent = person.getId();
      this.$$('.lifespan').textContent = person.getDisplayLifeSpan();
      this.$$('.loader').style.display = 'none';
    }

  });

</script>
